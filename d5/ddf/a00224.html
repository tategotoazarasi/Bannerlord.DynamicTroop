<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>动态装备系统: DynamicTroopEquipmentReupload.EveryoneCampaignBehavior Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">动态装备系统
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d3/d00/a00113.html">DynamicTroopEquipmentReupload</a></li><li class="navelem"><a class="el" href="../../d5/ddf/a00224.html">EveryoneCampaignBehavior</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="../../dd/d52/a00221.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">DynamicTroopEquipmentReupload.EveryoneCampaignBehavior Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for DynamicTroopEquipmentReupload.EveryoneCampaignBehavior:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d5/ddf/a00224.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dc2/a00228.html">Data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a848f68b66759fb2ac5c29768a8729597" id="r_a848f68b66759fb2ac5c29768a8729597"><td class="memItemLeft" align="right" valign="top">override void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a848f68b66759fb2ac5c29768a8729597">RegisterEvents</a> ()</td></tr>
<tr class="separator:a848f68b66759fb2ac5c29768a8729597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a1539ac4ecbd5bf42af1d620a7d9eb" id="r_ac2a1539ac4ecbd5bf42af1d620a7d9eb"><td class="memItemLeft" align="right" valign="top">override void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2a1539ac4ecbd5bf42af1d620a7d9eb">SyncData</a> (IDataStore dataStore)</td></tr>
<tr class="separator:ac2a1539ac4ecbd5bf42af1d620a7d9eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a37a997f04b6c4dabc65290195a38ee65" id="r_a37a997f04b6c4dabc65290195a38ee65"><td class="memItemLeft" align="right" valign="top">static readonly Dictionary&lt; ItemObject.ItemTypeEnum, Func&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37a997f04b6c4dabc65290195a38ee65">EquipmentAndThresholds</a></td></tr>
<tr class="separator:a37a997f04b6c4dabc65290195a38ee65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a01e9b809999805a925dfa8be45a3ec" id="r_a1a01e9b809999805a925dfa8be45a3ec"><td class="memItemLeft" align="right" valign="top">static readonly Dictionary&lt; ItemObject.ItemTypeEnum, List&lt; ItemObject &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a01e9b809999805a925dfa8be45a3ec">ItemListByType</a> = new()</td></tr>
<tr class="separator:a1a01e9b809999805a925dfa8be45a3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a127741273bf1c746a3a918789232fe9b" id="r_a127741273bf1c746a3a918789232fe9b"><td class="memItemLeft" align="right" valign="top">static Dictionary&lt; MBGUID, Dictionary&lt; ItemObject, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a127741273bf1c746a3a918789232fe9b">PartyArmories</a> = new()</td></tr>
<tr class="separator:a127741273bf1c746a3a918789232fe9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a881695abdcafe6a2ca365e6026217a4f" id="r_a881695abdcafe6a2ca365e6026217a4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a881695abdcafe6a2ca365e6026217a4f">AllocateRandomEquipmentToPartyArmory</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:a881695abdcafe6a2ca365e6026217a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb88f60d0605aeca33a47d24377ea44" id="r_a7cb88f60d0605aeca33a47d24377ea44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cb88f60d0605aeca33a47d24377ea44">DailyTickParty</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:a7cb88f60d0605aeca33a47d24377ea44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba7ba7a707b71d4176e907224c2476f" id="r_a5ba7ba7a707b71d4176e907224c2476f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ba7ba7a707b71d4176e907224c2476f">DistributeLootRandomly</a> (MapEventParty[] winnerParties, float totalWinnerStrength, IEnumerable&lt; MapEventParty &gt; loserParties)</td></tr>
<tr class="memdesc:a5ba7ba7a707b71d4176e907224c2476f"><td class="mdescLeft">&#160;</td><td class="mdescRight">根据战斗结果，随机分配战败方部队的战利品给胜利方的各个部队。  <br /></td></tr>
<tr class="separator:a5ba7ba7a707b71d4176e907224c2476f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938553ccc0973eb7e1eb33627e754a84" id="r_a938553ccc0973eb7e1eb33627e754a84"><td class="memItemLeft" align="right" valign="top">MapEventParty[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a938553ccc0973eb7e1eb33627e754a84">FilterValidParties</a> (IEnumerable&lt; MapEventParty &gt; parties)</td></tr>
<tr class="separator:a938553ccc0973eb7e1eb33627e754a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a277cbdd378543d4d5a39ad92833df" id="r_ac1a277cbdd378543d4d5a39ad92833df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1a277cbdd378543d4d5a39ad92833df">GarbageCollectEquipments</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:ac1a277cbdd378543d4d5a39ad92833df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea1ad27eda326d1faa6d4dee4280412a" id="r_aea1ad27eda326d1faa6d4dee4280412a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea1ad27eda326d1faa6d4dee4280412a">GarbageCollectParties</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:aea1ad27eda326d1faa6d4dee4280412a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae891d4d30a9c90d1be960aaec93bc93a" id="r_ae891d4d30a9c90d1be960aaec93bc93a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae891d4d30a9c90d1be960aaec93bc93a">MoveRosterToArmory</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:ae891d4d30a9c90d1be960aaec93bc93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acedcb47dfe1405f48ff4e3eecbd7081b" id="r_acedcb47dfe1405f48ff4e3eecbd7081b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acedcb47dfe1405f48ff4e3eecbd7081b">OnGameLoaded</a> (CampaignGameStarter starter)</td></tr>
<tr class="separator:acedcb47dfe1405f48ff4e3eecbd7081b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dec547d306c628279498b93e65fb72f" id="r_a9dec547d306c628279498b93e65fb72f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9dec547d306c628279498b93e65fb72f">OnMapEventEnded</a> (MapEvent mapEvent)</td></tr>
<tr class="separator:a9dec547d306c628279498b93e65fb72f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673b3f3f1cc1c5488344c21a1cf4872f" id="r_a673b3f3f1cc1c5488344c21a1cf4872f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a673b3f3f1cc1c5488344c21a1cf4872f">OnMobilePartyCreated</a> (MobileParty mobileParty)</td></tr>
<tr class="separator:a673b3f3f1cc1c5488344c21a1cf4872f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cde4570023b664d06b942d4d7d0989a" id="r_a9cde4570023b664d06b942d4d7d0989a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9cde4570023b664d06b942d4d7d0989a">OnMobilePartyDestroyed</a> (MobileParty mobileParty, PartyBase partyBase)</td></tr>
<tr class="separator:a9cde4570023b664d06b942d4d7d0989a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095509e52d7ebdac89ec617e568ba0fd" id="r_a095509e52d7ebdac89ec617e568ba0fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a095509e52d7ebdac89ec617e568ba0fd">OnNewGameCreated</a> (CampaignGameStarter starter)</td></tr>
<tr class="separator:a095509e52d7ebdac89ec617e568ba0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1979ab8566728a620705cc9da22d3019" id="r_a1979ab8566728a620705cc9da22d3019"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1979ab8566728a620705cc9da22d3019">WeeklyTick</a> ()</td></tr>
<tr class="separator:a1979ab8566728a620705cc9da22d3019"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a041e54d531cf6bbdfd39b8cd422ae5c0" id="r_a041e54d531cf6bbdfd39b8cd422ae5c0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a041e54d531cf6bbdfd39b8cd422ae5c0">AddItemToPartyArmory</a> (MBGUID partyId, ItemObject item, int count)</td></tr>
<tr class="memdesc:a041e54d531cf6bbdfd39b8cd422ae5c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">向指定部队的装备库中添加物品。  <br /></td></tr>
<tr class="separator:a041e54d531cf6bbdfd39b8cd422ae5c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8000ecadd247ad5e90c136c10f6a69" id="r_a2e8000ecadd247ad5e90c136c10f6a69"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e8000ecadd247ad5e90c136c10f6a69">CalculateTotalStrength</a> (IEnumerable&lt; MapEventParty &gt; parties)</td></tr>
<tr class="separator:a2e8000ecadd247ad5e90c136c10f6a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85904f3531138da4f9048e18560be02a" id="r_a85904f3531138da4f9048e18560be02a"><td class="memItemLeft" align="right" valign="top">static ? MobileParty&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85904f3531138da4f9048e18560be02a">ChoosePartyRandomly</a> (IEnumerable&lt; MapEventParty &gt; parties, float totalStrength, Random random)</td></tr>
<tr class="memdesc:a85904f3531138da4f9048e18560be02a"><td class="mdescLeft">&#160;</td><td class="mdescRight">从一系列部队中根据其总力量随机选择一个部队。  <br /></td></tr>
<tr class="separator:a85904f3531138da4f9048e18560be02a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83fb3a72110c1bf95963361dd4de7a9c" id="r_a83fb3a72110c1bf95963361dd4de7a9c"><td class="memItemLeft" align="right" valign="top">static Dictionary&lt; MBGUID, Dictionary&lt; ItemObject, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83fb3a72110c1bf95963361dd4de7a9c">ConvertToGuidDict</a> (Dictionary&lt; uint, Dictionary&lt; string, int &gt; &gt; uintDict)</td></tr>
<tr class="memdesc:a83fb3a72110c1bf95963361dd4de7a9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">将使用uint键和字符串ID的字典转换为包含MBGUID键和物品字典的字典。  <br /></td></tr>
<tr class="separator:a83fb3a72110c1bf95963361dd4de7a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973a3df777b2e5eed98ce113621f8f55" id="r_a973a3df777b2e5eed98ce113621f8f55"><td class="memItemLeft" align="right" valign="top">static Dictionary&lt; uint, Dictionary&lt; string, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a973a3df777b2e5eed98ce113621f8f55">ConvertToUIntGuidDict</a> (Dictionary&lt; MBGUID, Dictionary&lt; ItemObject, int &gt; &gt; guidDict)</td></tr>
<tr class="memdesc:a973a3df777b2e5eed98ce113621f8f55"><td class="mdescLeft">&#160;</td><td class="mdescRight">将包含MBGUID键和物品字典的字典转换为使用uint键和字符串ID的字典。  <br /></td></tr>
<tr class="separator:a973a3df777b2e5eed98ce113621f8f55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b81f44e5296e5f7ee73451658c9b6e0" id="r_a9b81f44e5296e5f7ee73451658c9b6e0"><td class="memItemLeft" align="right" valign="top">static Dictionary&lt; ItemObject, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b81f44e5296e5f7ee73451658c9b6e0">GetAllLootItems</a> (IEnumerable&lt; MapEventParty &gt; parties)</td></tr>
<tr class="separator:a9b81f44e5296e5f7ee73451658c9b6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da5e5e1c438a735d344ba6076d1d65d" id="r_a1da5e5e1c438a735d344ba6076d1d65d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1da5e5e1c438a735d344ba6076d1d65d">InitializeItemListByType</a> ()</td></tr>
<tr class="separator:a1da5e5e1c438a735d344ba6076d1d65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad891996ba15e12db079fec5595b1afa3" id="r_ad891996ba15e12db079fec5595b1afa3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad891996ba15e12db079fec5595b1afa3">IsMapEventPartyValid</a> (MapEventParty? party)</td></tr>
<tr class="separator:ad891996ba15e12db079fec5595b1afa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b5e9b694bd4077cc7c9968054faefb" id="r_a93b5e9b694bd4077cc7c9968054faefb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93b5e9b694bd4077cc7c9968054faefb">LogParties</a> (IEnumerable&lt; MapEventParty &gt; parties, string label)</td></tr>
<tr class="separator:a93b5e9b694bd4077cc7c9968054faefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3b53532a6cd49d7c1b79352cba4649" id="r_a4f3b53532a6cd49d7c1b79352cba4649"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f3b53532a6cd49d7c1b79352cba4649">OnTroopRecruited</a> (Hero? recruiterHero, Settlement recruitmentSettlement, Hero recruitmentSource, CharacterObject troop, int amount)</td></tr>
<tr class="memdesc:a4f3b53532a6cd49d7c1b79352cba4649"><td class="mdescLeft">&#160;</td><td class="mdescRight">当兵种被招募时的处理逻辑。  <br /></td></tr>
<tr class="separator:a4f3b53532a6cd49d7c1b79352cba4649"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-attribs" name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a74949c27fb8960a00ddaf2775e5d2b40" id="r_a74949c27fb8960a00ddaf2775e5d2b40"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/dc2/a00228.html">Data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74949c27fb8960a00ddaf2775e5d2b40">_data</a> = new()</td></tr>
<tr class="separator:a74949c27fb8960a00ddaf2775e5d2b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00027">27</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a041e54d531cf6bbdfd39b8cd422ae5c0" name="a041e54d531cf6bbdfd39b8cd422ae5c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041e54d531cf6bbdfd39b8cd422ae5c0">&#9670;&#160;</a></span>AddItemToPartyArmory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.AddItemToPartyArmory </td>
          <td>(</td>
          <td class="paramtype">MBGUID</td>          <td class="paramname"><span class="paramname"><em>partyId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ItemObject</td>          <td class="paramname"><span class="paramname"><em>item</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>count</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>向指定部队的装备库中添加物品。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">partyId</td><td>部队的唯一标识符。 </td></tr>
    <tr><td class="paramname">item</td><td>要添加的物品。 </td></tr>
    <tr><td class="paramname">count</td><td>添加的物品数量。 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00418">418</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  418</span>                                                                                         {</div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">if</span> (!PartyArmories.TryGetValue(partyId, out var inventory)) {</div>
<div class="line"><span class="lineno">  420</span>            inventory              = <span class="keyword">new</span> Dictionary&lt;ItemObject, int&gt;();</div>
<div class="line"><span class="lineno">  421</span>            PartyArmories[partyId] = inventory;</div>
<div class="line"><span class="lineno">  422</span>        }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">if</span> (!inventory.TryGetValue(item, out var currentCount)) currentCount = 0;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>        inventory[item] = currentCount + count;</div>
<div class="line"><span class="lineno">  427</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00215">AllocateRandomEquipmentToPartyArmory()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00309">DistributeLootRandomly()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00201">MoveRosterToArmory()</a>.</p>

</div>
</div>
<a id="a881695abdcafe6a2ca365e6026217a4f" name="a881695abdcafe6a2ca365e6026217a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881695abdcafe6a2ca365e6026217a4f">&#9670;&#160;</a></span>AllocateRandomEquipmentToPartyArmory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.AllocateRandomEquipmentToPartyArmory </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00215">215</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>                                                                               {</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">if</span> (mobileParty.MemberRoster                  == <span class="keyword">null</span> ||</div>
<div class="line"><span class="lineno">  217</span>            mobileParty.MemberRoster.GetTroopRoster() == <span class="keyword">null</span> ||</div>
<div class="line"><span class="lineno">  218</span>            mobileParty.MemberRoster.GetTroopRoster().IsEmpty())</div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>        var randomEquipmentElementsFromTroop = mobileParty.GetRandomEquipmentsFromTroop();</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">foreach</span> (var equipmentElement <span class="keywordflow">in</span> randomEquipmentElementsFromTroop) {</div>
<div class="line"><span class="lineno">  223</span>            AddItemToPartyArmory(mobileParty.Id, equipmentElement.Item, 1);</div>
<div class="line"><span class="lineno">  224</span>            Global.Debug($<span class="stringliteral">&quot;random equipment (troop) {equipmentElement.Item.Name} added to {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>        var randomItemsFromFiefs = mobileParty.GetDailyEquipmentFromFiefs();</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">foreach</span> (var item <span class="keywordflow">in</span> randomItemsFromFiefs) {</div>
<div class="line"><span class="lineno">  229</span>            AddItemToPartyArmory(mobileParty.Id, item, 1);</div>
<div class="line"><span class="lineno">  230</span>            Global.Debug($<span class="stringliteral">&quot;random equipment (fief) {item.Name} added to {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  231</span>        }</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>        var randomItemsFromClan = mobileParty.GetRandomEquipmentsFromClan();</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">foreach</span> (var item <span class="keywordflow">in</span> randomItemsFromClan) {</div>
<div class="line"><span class="lineno">  235</span>            AddItemToPartyArmory(mobileParty.Id, item, 1);</div>
<div class="line"><span class="lineno">  236</span>            Global.Debug($<span class="stringliteral">&quot;random equipment (clan) {item.Name} added to {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  237</span>        }</div>
<div class="line"><span class="lineno">  238</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00418">AddItemToPartyArmory()</a>, and <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00163">DailyTickParty()</a>.</p>

</div>
</div>
<a id="a2e8000ecadd247ad5e90c136c10f6a69" name="a2e8000ecadd247ad5e90c136c10f6a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8000ecadd247ad5e90c136c10f6a69">&#9670;&#160;</a></span>CalculateTotalStrength()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.CalculateTotalStrength </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>parties</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00299">299</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  299</span>                                                                                    {</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">return</span> parties.SumQ(party =&gt; party.Party.EstimatedStrength);</div>
<div class="line"><span class="lineno">  301</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00271">OnMapEventEnded()</a>.</p>

</div>
</div>
<a id="a85904f3531138da4f9048e18560be02a" name="a85904f3531138da4f9048e18560be02a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85904f3531138da4f9048e18560be02a">&#9670;&#160;</a></span>ChoosePartyRandomly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ? MobileParty DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.ChoosePartyRandomly </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>parties</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>totalStrength</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Random</td>          <td class="paramname"><span class="paramname"><em>random</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>从一系列部队中根据其总力量随机选择一个部队。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parties</td><td>参与选择的部队集合。 </td></tr>
    <tr><td class="paramname">totalStrength</td><td>所有部队的总力量。 </td></tr>
    <tr><td class="paramname">random</td><td>用于生成随机数的Random实例。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>根据力量加权随机选中的移动部队，如果没有选中则返回null。 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00361">361</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  363</span>                                                                                       {</div>
<div class="line"><span class="lineno">  364</span>        var randomValue        = random.NextDouble() * totalStrength;</div>
<div class="line"><span class="lineno">  365</span>        var cumulativeStrength = 0f;</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">foreach</span> (var party <span class="keywordflow">in</span> parties) {</div>
<div class="line"><span class="lineno">  368</span>            cumulativeStrength += party.Party.EstimatedStrength;</div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordflow">if</span> (cumulativeStrength &gt;= randomValue) <span class="keywordflow">return</span> party.Party.MobileParty;</div>
<div class="line"><span class="lineno">  370</span>        }</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  373</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00309">DistributeLootRandomly()</a>.</p>

</div>
</div>
<a id="a83fb3a72110c1bf95963361dd4de7a9c" name="a83fb3a72110c1bf95963361dd4de7a9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83fb3a72110c1bf95963361dd4de7a9c">&#9670;&#160;</a></span>ConvertToGuidDict()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Dictionary&lt; MBGUID, Dictionary&lt; ItemObject, int &gt; &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.ConvertToGuidDict </td>
          <td>(</td>
          <td class="paramtype">Dictionary&lt; uint, Dictionary&lt; string, int &gt; &gt;</td>          <td class="paramname"><span class="paramname"><em>uintDict</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>将使用uint键和字符串ID的字典转换为包含MBGUID键和物品字典的字典。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uintDict</td><td>以uint为键，以物品字符串ID和数量的字典为值的字典。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>转换后的字典，其中键为MBGUID类型，值为以物品对象和数量构成的字典。 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00482">482</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  483</span>                                                            {</div>
<div class="line"><span class="lineno">  484</span>        Dictionary&lt;MBGUID, Dictionary&lt;ItemObject, int&gt;&gt; guidDict = <span class="keyword">new</span>();</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">foreach</span> (var pair <span class="keywordflow">in</span> uintDict) {</div>
<div class="line"><span class="lineno">  486</span>            <span class="keywordflow">if</span> (!guidDict.TryGetValue(<span class="keyword">new</span> MBGUID(pair.Key), out var innerDict)) {</div>
<div class="line"><span class="lineno">  487</span>                innerDict = <span class="keyword">new</span> Dictionary&lt;ItemObject, int&gt;();</div>
<div class="line"><span class="lineno">  488</span>                guidDict.Add(<span class="keyword">new</span> MBGUID(pair.Key), innerDict);</div>
<div class="line"><span class="lineno">  489</span>            }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>            <span class="keywordflow">foreach</span> (var innerPair <span class="keywordflow">in</span> pair.Value) {</div>
<div class="line"><span class="lineno">  492</span>                var itemObject = MBObjectManager.Instance.GetObject&lt;ItemObject&gt;(innerPair.Key) ??</div>
<div class="line"><span class="lineno">  493</span>                                 ItemObject.GetCraftedItemObjectFromHashedCode(innerPair.Key);</div>
<div class="line"><span class="lineno">  494</span>                <span class="keywordflow">if</span> (itemObject != <span class="keyword">null</span> &amp;&amp; innerPair.Value &gt; 0) {</div>
<div class="line"><span class="lineno">  495</span>                    <span class="keywordflow">if</span> (innerDict.ContainsKey(itemObject))</div>
<div class="line"><span class="lineno">  496</span>                        innerDict[itemObject] += innerPair.Value;</div>
<div class="line"><span class="lineno">  497</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  498</span>                        innerDict.Add(itemObject, innerPair.Value);</div>
<div class="line"><span class="lineno">  499</span>                }</div>
<div class="line"><span class="lineno">  500</span>                <span class="keywordflow">else</span> { Global.Warn($<span class="stringliteral">&quot;cannot get object {innerPair.Key}&quot;</span>); }</div>
<div class="line"><span class="lineno">  501</span>            }</div>
<div class="line"><span class="lineno">  502</span>        }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">return</span> guidDict;</div>
<div class="line"><span class="lineno">  505</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00159">DynamicTroopEquipmentReupload.Global.Warn()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00099">SyncData()</a>.</p>

</div>
</div>
<a id="a973a3df777b2e5eed98ce113621f8f55" name="a973a3df777b2e5eed98ce113621f8f55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a973a3df777b2e5eed98ce113621f8f55">&#9670;&#160;</a></span>ConvertToUIntGuidDict()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Dictionary&lt; uint, Dictionary&lt; string, int &gt; &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.ConvertToUIntGuidDict </td>
          <td>(</td>
          <td class="paramtype">Dictionary&lt; MBGUID, Dictionary&lt; ItemObject, int &gt; &gt;</td>          <td class="paramname"><span class="paramname"><em>guidDict</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>将包含MBGUID键和物品字典的字典转换为使用uint键和字符串ID的字典。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guidDict</td><td>以MBGUID为键，以物品和数量的字典为值的字典。 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>转换后的字典，其中键为uint类型，值为以物品字符串ID和数量构成的字典。 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00438">438</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  439</span>                                                                  {</div>
<div class="line"><span class="lineno">  440</span>        Dictionary&lt;uint, Dictionary&lt;string, int&gt;&gt; uintDict = <span class="keyword">new</span>();</div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">foreach</span> (var pair <span class="keywordflow">in</span> guidDict) {</div>
<div class="line"><span class="lineno">  442</span>            var party = Campaign.Current.MobileParties.FirstOrDefault(party =&gt; party.Id == pair.Key);</div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordflow">if</span> (party is not {</div>
<div class="line"><span class="lineno">  444</span>                                 LeaderHero: {</div>
<div class="line"><span class="lineno">  445</span>                                                 CharacterObject       : { IsHero: <span class="keyword">true</span>, IsPlayerCharacter: <span class="keyword">false</span> },</div>
<div class="line"><span class="lineno">  446</span>                                                 IsHumanPlayerCharacter: <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  447</span>                                                 IsPartyLeader         : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  448</span>                                                 IsAlive               : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  449</span>                                                 IsActive              : <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  450</span>                                             },</div>
<div class="line"><span class="lineno">  451</span>                                 Owner: {</div>
<div class="line"><span class="lineno">  452</span>                                            CharacterObject       : { IsHero: <span class="keyword">true</span>, IsPlayerCharacter: <span class="keyword">false</span> },</div>
<div class="line"><span class="lineno">  453</span>                                            IsHumanPlayerCharacter: <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  454</span>                                            IsActive              : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  455</span>                                            IsAlive               : <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  456</span>                                        },</div>
<div class="line"><span class="lineno">  457</span>                                 MemberRoster: { TotalHeroes: &gt; 0, TotalManCount: &gt; 0 },</div>
<div class="line"><span class="lineno">  458</span>                                 IsDisbanding: <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  459</span>                             }) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">if</span> (!uintDict.TryGetValue(pair.Key.InternalValue, out var innerDict)) {</div>
<div class="line"><span class="lineno">  461</span>                innerDict = <span class="keyword">new</span> Dictionary&lt;string, int&gt;();</div>
<div class="line"><span class="lineno">  462</span>                uintDict.Add(pair.Key.InternalValue, innerDict);</div>
<div class="line"><span class="lineno">  463</span>            }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>            <span class="keywordflow">foreach</span> (var innerPair <span class="keywordflow">in</span> pair.Value)</div>
<div class="line"><span class="lineno">  466</span>                <span class="keywordflow">if</span> (innerPair is { Key: not <span class="keyword">null</span>, Value: &gt; 0 }) {</div>
<div class="line"><span class="lineno">  467</span>                    <span class="keywordflow">if</span> (innerDict.ContainsKey(innerPair.Key.StringId))</div>
<div class="line"><span class="lineno">  468</span>                        innerDict[innerPair.Key.StringId] += innerPair.Value;</div>
<div class="line"><span class="lineno">  469</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  470</span>                        innerDict.Add(innerPair.Key.StringId, innerPair.Value);</div>
<div class="line"><span class="lineno">  471</span>                }</div>
<div class="line"><span class="lineno">  472</span>        }</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span> uintDict;</div>
<div class="line"><span class="lineno">  475</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00099">SyncData()</a>.</p>

</div>
</div>
<a id="a7cb88f60d0605aeca33a47d24377ea44" name="a7cb88f60d0605aeca33a47d24377ea44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb88f60d0605aeca33a47d24377ea44">&#9670;&#160;</a></span>DailyTickParty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.DailyTickParty </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00163">163</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                                         {</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> (!mobileParty.IsValid()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">if</span> (!GarbageCollectParties(mobileParty))</div>
<div class="line"><span class="lineno">  167</span>            AllocateRandomEquipmentToPartyArmory(mobileParty);</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  169</span>            Global.Debug($<span class="stringliteral">&quot;garbage collect party {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">if</span> (CampaignTime.Now.GetDayOfWeek != mobileParty.Id.InternalValue % 7) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        GarbageCollectEquipments(mobileParty);</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>        <span class="comment">//ReplenishBasicTroopEquipments(mobileParty);</span></div>
<div class="line"><span class="lineno">  176</span>        MoveRosterToArmory(mobileParty);</div>
<div class="line"><span class="lineno">  177</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00215">AllocateRandomEquipmentToPartyArmory()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00128">GarbageCollectEquipments()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00179">GarbageCollectParties()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00201">MoveRosterToArmory()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a5ba7ba7a707b71d4176e907224c2476f" name="a5ba7ba7a707b71d4176e907224c2476f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba7ba7a707b71d4176e907224c2476f">&#9670;&#160;</a></span>DistributeLootRandomly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.DistributeLootRandomly </td>
          <td>(</td>
          <td class="paramtype">MapEventParty[]</td>          <td class="paramname"><span class="paramname"><em>winnerParties</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>totalWinnerStrength</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>loserParties</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>根据战斗结果，随机分配战败方部队的战利品给胜利方的各个部队。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">winnerParties</td><td>胜利方的部队数组。 </td></tr>
    <tr><td class="paramname">totalWinnerStrength</td><td>胜利方部队的总力量。 </td></tr>
    <tr><td class="paramname">loserParties</td><td>战败方的部队集合。 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00309">309</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>                                                                                 {</div>
<div class="line"><span class="lineno">  312</span>        Random                  random             = <span class="keyword">new</span>();</div>
<div class="line"><span class="lineno">  313</span>        var                     lootItemsWithCount = GetAllLootItems(loserParties);</div>
<div class="line"><span class="lineno">  314</span>        Dictionary&lt;MBGUID, int&gt; partyLootCount     = <span class="keyword">new</span>();</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">foreach</span> (var lootItem <span class="keywordflow">in</span> lootItemsWithCount) {</div>
<div class="line"><span class="lineno">  317</span>            var item      = lootItem.Key;</div>
<div class="line"><span class="lineno">  318</span>            var itemCount = lootItem.Value;</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>            <span class="keywordflow">for</span> (var i = 0; i &lt; itemCount; i++) {</div>
<div class="line"><span class="lineno">  321</span>                var chosenParty = ChoosePartyRandomly(winnerParties, totalWinnerStrength, random);</div>
<div class="line"><span class="lineno">  322</span>                <span class="keywordflow">if</span> (chosenParty == <span class="keyword">null</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>                AddItemToPartyArmory(chosenParty.Id, item, 1);</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>                <span class="comment">// 更新统计信息</span></div>
<div class="line"><span class="lineno">  327</span>                <span class="keywordflow">if</span> (partyLootCount.ContainsKey(chosenParty.Id))</div>
<div class="line"><span class="lineno">  328</span>                    partyLootCount[chosenParty.Id]++;</div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  330</span>                    partyLootCount[chosenParty.Id] = 1;</div>
<div class="line"><span class="lineno">  331</span>            }</div>
<div class="line"><span class="lineno">  332</span>        }</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>        <span class="comment">// 记录每个party获得的物品总数</span></div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordflow">foreach</span> (var partyCount <span class="keywordflow">in</span> partyLootCount)</div>
<div class="line"><span class="lineno">  336</span>            Global.Debug($<span class="stringliteral">&quot;Party {partyCount.Key} looted {partyCount.Value} items&quot;</span>);</div>
<div class="line"><span class="lineno">  337</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00418">AddItemToPartyArmory()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00361">ChoosePartyRandomly()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00339">GetAllLootItems()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00271">OnMapEventEnded()</a>.</p>

</div>
</div>
<a id="a938553ccc0973eb7e1eb33627e754a84" name="a938553ccc0973eb7e1eb33627e754a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938553ccc0973eb7e1eb33627e754a84">&#9670;&#160;</a></span>FilterValidParties()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MapEventParty[] DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.FilterValidParties </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>parties</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00290">290</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>                                                                                   {</div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">return</span> parties.WhereQ(IsMapEventPartyValid).ToArrayQ();</div>
<div class="line"><span class="lineno">  292</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00429">IsMapEventPartyValid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00271">OnMapEventEnded()</a>.</p>

</div>
</div>
<a id="ac1a277cbdd378543d4d5a39ad92833df" name="ac1a277cbdd378543d4d5a39ad92833df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a277cbdd378543d4d5a39ad92833df">&#9670;&#160;</a></span>GarbageCollectEquipments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.GarbageCollectEquipments </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00128">128</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                                                                   {</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">if</span> (!mobileParty.IsValid() || mobileParty.MemberRoster?.GetTroopRoster() == <span class="keyword">null</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>        var memberCnt = mobileParty.MemberRoster.GetTroopRoster()</div>
<div class="line"><span class="lineno">  132</span>                                   .WhereQ(element =&gt; element.Character is { IsHero: false })</div>
<div class="line"><span class="lineno">  133</span>                                   .SumQ(element =&gt; element.Number);</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">foreach</span> (var equipmentAndThreshold <span class="keywordflow">in</span> EquipmentAndThresholds) {</div>
<div class="line"><span class="lineno">  135</span>            var partyArmory = PartyArmories.GetValueSafe(mobileParty.Id);</div>
<div class="line"><span class="lineno">  136</span>            <span class="keywordflow">if</span> (partyArmory == <span class="keyword">null</span> || partyArmory.IsEmpty()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>            var armorTotalCount = partyArmory.WhereQ(kv =&gt; kv.Key.ItemType == equipmentAndThreshold.Key)</div>
<div class="line"><span class="lineno">  139</span>                                             .SumQ(kv =&gt; kv.Value);</div>
<div class="line"><span class="lineno">  140</span>            var surplusCount = armorTotalCount - memberCnt;</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span> (surplusCount &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>            var surplusCountCpy = surplusCount;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>            <span class="comment">// 创建优先级队列</span></div>
<div class="line"><span class="lineno">  146</span>            <a class="code hl_typedef" href="../../d7/d46/a00002.html#a7c5d1fd7721987ec300c0ab950972b31">ItemPriorityQueue</a> armorQueue = <span class="keyword">new</span>(<span class="keyword">new</span> EquipmentEffectivenessComparer());</div>
<div class="line"><span class="lineno">  147</span>            <span class="keywordflow">foreach</span> (var kv <span class="keywordflow">in</span> partyArmory.WhereQ(kv =&gt; kv.Key.ItemType == equipmentAndThreshold.Key))</div>
<div class="line"><span class="lineno">  148</span>                armorQueue.Enqueue(kv.Key, ((<span class="keywordtype">int</span>)kv.Key.Tier, kv.Key.Value));</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>            <span class="comment">// 移除多余的装备</span></div>
<div class="line"><span class="lineno">  151</span>            <span class="keywordflow">while</span> (surplusCount &gt; 0 &amp;&amp; armorQueue.Count &gt; 0) {</div>
<div class="line"><span class="lineno">  152</span>                var lowestArmor   = armorQueue.Dequeue();</div>
<div class="line"><span class="lineno">  153</span>                var countToRemove = Math.Min(partyArmory[lowestArmor.Key], surplusCount);</div>
<div class="line"><span class="lineno">  154</span>                partyArmory[lowestArmor.Key] -= countToRemove;</div>
<div class="line"><span class="lineno">  155</span>                surplusCount                 -= countToRemove;</div>
<div class="line"><span class="lineno">  156</span>                <span class="keywordflow">if</span> (partyArmory[lowestArmor.Key] == 0) _ = partyArmory.Remove(lowestArmor.Key);</div>
<div class="line"><span class="lineno">  157</span>            }</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>            Global.Debug($<span class="stringliteral">&quot;Garbage collected {surplusCountCpy - surplusCount}x{equipmentAndThreshold.Key} armors from party {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>        }</div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="ttc" id="aa00002_html_a7c5d1fd7721987ec300c0ab950972b31"><div class="ttname"><a href="../../d7/d46/a00002.html#a7c5d1fd7721987ec300c0ab950972b31">ItemPriorityQueue</a></div><div class="ttdeci">TaleWorlds.Library.PriorityQueue&lt; TaleWorlds.Core.EquipmentElement, int &gt; ItemPriorityQueue</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d46/a00002_source.html#l00019">ArmyArmory.cs:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00032">EquipmentAndThresholds</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00163">DailyTickParty()</a>.</p>

</div>
</div>
<a id="aea1ad27eda326d1faa6d4dee4280412a" name="aea1ad27eda326d1faa6d4dee4280412a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea1ad27eda326d1faa6d4dee4280412a">&#9670;&#160;</a></span>GarbageCollectParties()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.GarbageCollectParties </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00179">179</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                                                {</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> (mobileParty is not {</div>
<div class="line"><span class="lineno">  181</span>                                   LeaderHero: {</div>
<div class="line"><span class="lineno">  182</span>                                                   CharacterObject       : { IsHero: <span class="keyword">true</span>, IsPlayerCharacter: <span class="keyword">false</span> },</div>
<div class="line"><span class="lineno">  183</span>                                                   IsHumanPlayerCharacter: <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  184</span>                                                   IsPartyLeader         : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  185</span>                                                   IsAlive               : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  186</span>                                                   IsActive              : <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  187</span>                                               },</div>
<div class="line"><span class="lineno">  188</span>                                   Owner: {</div>
<div class="line"><span class="lineno">  189</span>                                              CharacterObject       : { IsHero: <span class="keyword">true</span>, IsPlayerCharacter: <span class="keyword">false</span> },</div>
<div class="line"><span class="lineno">  190</span>                                              IsHumanPlayerCharacter: <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  191</span>                                              IsActive              : <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  192</span>                                              IsAlive               : <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  193</span>                                          },</div>
<div class="line"><span class="lineno">  194</span>                                   MemberRoster: { TotalHeroes: &gt; 0, TotalManCount: &gt; 0 },</div>
<div class="line"><span class="lineno">  195</span>                                   IsDisbanding: <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  196</span>                               })</div>
<div class="line"><span class="lineno">  197</span>            <span class="keywordflow">return</span> PartyArmories.Remove(mobileParty.Id);</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  199</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00163">DailyTickParty()</a>.</p>

</div>
</div>
<a id="a9b81f44e5296e5f7ee73451658c9b6e0" name="a9b81f44e5296e5f7ee73451658c9b6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b81f44e5296e5f7ee73451658c9b6e0">&#9670;&#160;</a></span>GetAllLootItems()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Dictionary&lt; ItemObject, int &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.GetAllLootItems </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>parties</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00339">339</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  339</span>                                                                                                   {</div>
<div class="line"><span class="lineno">  340</span>        Dictionary&lt;ItemObject, int&gt; itemsWithCount = <span class="keyword">new</span>();</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">foreach</span> (var party <span class="keywordflow">in</span> parties)</div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">if</span> (PartyArmories.TryGetValue(party.Party.MobileParty.Id, out var inventory))</div>
<div class="line"><span class="lineno">  343</span>                <span class="keywordflow">foreach</span> (var item <span class="keywordflow">in</span> inventory) {</div>
<div class="line"><span class="lineno">  344</span>                    <span class="keywordflow">if</span> (!ItemBlackList.Test(item.Key)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  345</span>                    <span class="keywordflow">if</span> (itemsWithCount.ContainsKey(item.Key))</div>
<div class="line"><span class="lineno">  346</span>                        itemsWithCount[item.Key] += item.Value;</div>
<div class="line"><span class="lineno">  347</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  348</span>                        itemsWithCount.Add(item.Key, item.Value);</div>
<div class="line"><span class="lineno">  349</span>                }</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">return</span> itemsWithCount;</div>
<div class="line"><span class="lineno">  352</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>, and <a class="el" href="../../d4/d81/a00110_source.html#l00121">DynamicTroopEquipmentReupload.ItemBlackList.Test()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00309">DistributeLootRandomly()</a>.</p>

</div>
</div>
<a id="a1da5e5e1c438a735d344ba6076d1d65d" name="a1da5e5e1c438a735d344ba6076d1d65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1da5e5e1c438a735d344ba6076d1d65d">&#9670;&#160;</a></span>InitializeItemListByType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.InitializeItemListByType </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00053">53</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                                   {</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">foreach</span> (var itemType <span class="keywordflow">in</span> Global.ItemTypes) {</div>
<div class="line"><span class="lineno">   55</span>            var items = MBObjectManager.Instance.GetObjectTypeList&lt;ItemObject&gt;()</div>
<div class="line"><span class="lineno">   56</span>                                       ?.WhereQ(item =&gt; item != <span class="keyword">null</span> &amp;&amp; item.ItemType == itemType)</div>
<div class="line"><span class="lineno">   57</span>                                       ?.OrderByQ(item =&gt; item.Tier)</div>
<div class="line"><span class="lineno">   58</span>                                       ?.ThenBy(item =&gt; item.Value)</div>
<div class="line"><span class="lineno">   59</span>                                       .ToListQ();</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>            ItemListByType[itemType] = items ?? <span class="keyword">new</span> List&lt;ItemObject&gt;();</div>
<div class="line"><span class="lineno">   62</span>        }</div>
<div class="line"><span class="lineno">   63</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00051">ItemListByType</a>, and <a class="el" href="../../d4/dee/a00008_source.html#l00054">DynamicTroopEquipmentReupload.Global.ItemTypes</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="ad891996ba15e12db079fec5595b1afa3" name="ad891996ba15e12db079fec5595b1afa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad891996ba15e12db079fec5595b1afa3">&#9670;&#160;</a></span>IsMapEventPartyValid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.IsMapEventPartyValid </td>
          <td>(</td>
          <td class="paramtype">MapEventParty?</td>          <td class="paramname"><span class="paramname"><em>party</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00429">429</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  429</span>                                                                   {</div>
<div class="line"><span class="lineno">  430</span>        <span class="keywordflow">return</span> party is { Party.MobileParty: var mobileParty } &amp;&amp; mobileParty.IsValid();</div>
<div class="line"><span class="lineno">  431</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00290">FilterValidParties()</a>.</p>

</div>
</div>
<a id="a93b5e9b694bd4077cc7c9968054faefb" name="a93b5e9b694bd4077cc7c9968054faefb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93b5e9b694bd4077cc7c9968054faefb">&#9670;&#160;</a></span>LogParties()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.LogParties </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; MapEventParty &gt;</td>          <td class="paramname"><span class="paramname"><em>parties</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>label</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00294">294</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>                                                                                     {</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">foreach</span> (var party <span class="keywordflow">in</span> parties)</div>
<div class="line"><span class="lineno">  296</span>            Global.Log($<span class="stringliteral">&quot;{label} party: {party.Party.Name}#{party.Party.MobileParty.Id}&quot;</span>, Colors.Green, Level.Debug);</div>
<div class="line"><span class="lineno">  297</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00121">DynamicTroopEquipmentReupload.Global.Log()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00271">OnMapEventEnded()</a>.</p>

</div>
</div>
<a id="ae891d4d30a9c90d1be960aaec93bc93a" name="ae891d4d30a9c90d1be960aaec93bc93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae891d4d30a9c90d1be960aaec93bc93a">&#9670;&#160;</a></span>MoveRosterToArmory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.MoveRosterToArmory </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00201">201</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  201</span>                                                             {</div>
<div class="line"><span class="lineno">  202</span>        var elements = mobileParty.ItemRoster.WhereQ(element =&gt;</div>
<div class="line"><span class="lineno">  203</span>                                                         (element.EquipmentElement.Item?.HasArmorComponent  ?? <span class="keyword">false</span>) ||</div>
<div class="line"><span class="lineno">  204</span>                                                         (element.EquipmentElement.Item?.HasWeaponComponent ?? <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">foreach</span> (var element <span class="keywordflow">in</span> elements)</div>
<div class="line"><span class="lineno">  206</span>            <span class="keywordflow">if</span> (element.EquipmentElement.Item != <span class="keyword">null</span>) {</div>
<div class="line"><span class="lineno">  207</span>                AddItemToPartyArmory(mobileParty.Id, element.EquipmentElement.Item, element.Amount);</div>
<div class="line"><span class="lineno">  208</span>                Global.Debug($<span class="stringliteral">&quot;equipment {element.EquipmentElement.Item.Name}x{element.Amount} moved to armory from {mobileParty.Name}&quot;</span>);</div>
<div class="line"><span class="lineno">  209</span>                mobileParty.ItemRoster.Remove(element);</div>
<div class="line"><span class="lineno">  210</span>                var hero                    = mobileParty.LeaderHero ?? mobileParty.Owner;</div>
<div class="line"><span class="lineno">  211</span>                <span class="keywordflow">if</span> (hero != <span class="keyword">null</span>) hero.Gold += element.EquipmentElement.Item.Value * element.Amount;</div>
<div class="line"><span class="lineno">  212</span>            }</div>
<div class="line"><span class="lineno">  213</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00418">AddItemToPartyArmory()</a>, and <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00163">DailyTickParty()</a>.</p>

</div>
</div>
<a id="acedcb47dfe1405f48ff4e3eecbd7081b" name="acedcb47dfe1405f48ff4e3eecbd7081b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acedcb47dfe1405f48ff4e3eecbd7081b">&#9670;&#160;</a></span>OnGameLoaded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnGameLoaded </td>
          <td>(</td>
          <td class="paramtype">CampaignGameStarter</td>          <td class="paramname"><span class="paramname"><em>starter</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00087">87</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   87</span>                                                           {</div>
<div class="line"><span class="lineno">   88</span>        Global.Debug(<span class="stringliteral">&quot;OnGameLoaded() called&quot;</span>);</div>
<div class="line"><span class="lineno">   89</span>        IEnumerable&lt;MobileParty&gt;? validParties = Campaign.Current?.MobileParties?.WhereQ(party =&gt; party.IsValid());</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">if</span> (validParties == <span class="keyword">null</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">foreach</span> (var validParty <span class="keywordflow">in</span> validParties)</div>
<div class="line"><span class="lineno">   93</span>            <span class="keywordflow">if</span> (!PartyArmories.ContainsKey(validParty.Id))</div>
<div class="line"><span class="lineno">   94</span>                OnMobilePartyCreated(validParty);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>        CharacterObjectExtension.Init();</div>
<div class="line"><span class="lineno">   97</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, <a class="el" href="../../dc/d87/a00032_source.html#l00081">DynamicTroopEquipmentReupload.Extensions.CharacterObjectExtension.Init()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00240">OnMobilePartyCreated()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a9dec547d306c628279498b93e65fb72f" name="a9dec547d306c628279498b93e65fb72f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dec547d306c628279498b93e65fb72f">&#9670;&#160;</a></span>OnMapEventEnded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnMapEventEnded </td>
          <td>(</td>
          <td class="paramtype">MapEvent</td>          <td class="paramname"><span class="paramname"><em>mapEvent</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00271">271</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  271</span>                                                    {</div>
<div class="line"><span class="lineno">  272</span>        Global.Log($<span class="stringliteral">&quot;Map Event ended with state {mapEvent.BattleState}&quot;</span>, Colors.Green, Level.Debug);</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">if</span> (mapEvent.BattleState is not BattleState.AttackerVictory and not BattleState.DefenderVictory) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        var validWinnerParties = FilterValidParties(mapEvent.BattleState == BattleState.AttackerVictory</div>
<div class="line"><span class="lineno">  276</span>                                                        ? mapEvent.AttackerSide.Parties</div>
<div class="line"><span class="lineno">  277</span>                                                        : mapEvent.DefenderSide.Parties)</div>
<div class="line"><span class="lineno">  278</span>            .ToArrayQ();</div>
<div class="line"><span class="lineno">  279</span>        var validLoserParties = FilterValidParties(mapEvent.BattleState == BattleState.AttackerVictory</div>
<div class="line"><span class="lineno">  280</span>                                                       ? mapEvent.DefenderSide.Parties</div>
<div class="line"><span class="lineno">  281</span>                                                       : mapEvent.AttackerSide.Parties);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>        LogParties(validWinnerParties, <span class="stringliteral">&quot;Winning&quot;</span>);</div>
<div class="line"><span class="lineno">  284</span>        LogParties(validLoserParties,  <span class="stringliteral">&quot;Defeated&quot;</span>);</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>        var totalWinnerStrength = CalculateTotalStrength(validWinnerParties);</div>
<div class="line"><span class="lineno">  287</span>        DistributeLootRandomly(validWinnerParties, totalWinnerStrength, validLoserParties);</div>
<div class="line"><span class="lineno">  288</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00299">CalculateTotalStrength()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00309">DistributeLootRandomly()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00290">FilterValidParties()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00121">DynamicTroopEquipmentReupload.Global.Log()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00294">LogParties()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a673b3f3f1cc1c5488344c21a1cf4872f" name="a673b3f3f1cc1c5488344c21a1cf4872f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673b3f3f1cc1c5488344c21a1cf4872f">&#9670;&#160;</a></span>OnMobilePartyCreated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnMobilePartyCreated </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00240">240</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>                                                               {</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (!mobileParty.IsValid()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">if</span> (!PartyArmories.TryGetValue(mobileParty.Id, out var itemDict)) {</div>
<div class="line"><span class="lineno">  244</span>            itemDict                      = <span class="keyword">new</span> Dictionary&lt;ItemObject, int&gt;();</div>
<div class="line"><span class="lineno">  245</span>            PartyArmories[mobileParty.Id] = itemDict;</div>
<div class="line"><span class="lineno">  246</span>        }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>        var list = mobileParty.GetItems();</div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">foreach</span> (var element <span class="keywordflow">in</span> list) {</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">if</span> (!itemDict.TryGetValue(element.Item, out var count)) count = 0;</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>            itemDict[element.Item] = count + 1;</div>
<div class="line"><span class="lineno">  253</span>        }</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>        Global.Log($<span class="stringliteral">&quot;Mobile party {mobileParty.Name} created, {list.Count} start equipment added&quot;</span>,</div>
<div class="line"><span class="lineno">  256</span>                   Colors.Green,</div>
<div class="line"><span class="lineno">  257</span>                   Level.Debug);</div>
<div class="line"><span class="lineno">  258</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00121">DynamicTroopEquipmentReupload.Global.Log()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00087">OnGameLoaded()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a9cde4570023b664d06b942d4d7d0989a" name="a9cde4570023b664d06b942d4d7d0989a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cde4570023b664d06b942d4d7d0989a">&#9670;&#160;</a></span>OnMobilePartyDestroyed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnMobilePartyDestroyed </td>
          <td>(</td>
          <td class="paramtype">MobileParty</td>          <td class="paramname"><span class="paramname"><em>mobileParty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PartyBase</td>          <td class="paramname"><span class="paramname"><em>partyBase</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00260">260</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  260</span>                                                                                      {</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">if</span> (mobileParty?.Id != <span class="keyword">null</span>) _ = PartyArmories.Remove(mobileParty.Id);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">if</span> (!mobileParty.IsValid()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">if</span> (mobileParty is { Name: not <span class="keyword">null</span> } &amp;&amp; partyBase is { Name: not <span class="keyword">null</span> })</div>
<div class="line"><span class="lineno">  266</span>            Global.Log($<span class="stringliteral">&quot;Mobile party {mobileParty.Name} destroyed, partyBase = {partyBase.Name}&quot;</span>,</div>
<div class="line"><span class="lineno">  267</span>                       Colors.Green,</div>
<div class="line"><span class="lineno">  268</span>                       Level.Debug);</div>
<div class="line"><span class="lineno">  269</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00121">DynamicTroopEquipmentReupload.Global.Log()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a095509e52d7ebdac89ec617e568ba0fd" name="a095509e52d7ebdac89ec617e568ba0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095509e52d7ebdac89ec617e568ba0fd">&#9670;&#160;</a></span>OnNewGameCreated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnNewGameCreated </td>
          <td>(</td>
          <td class="paramtype">CampaignGameStarter</td>          <td class="paramname"><span class="paramname"><em>starter</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00079">79</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>                                                               {</div>
<div class="line"><span class="lineno">   80</span>        Global.Debug(<span class="stringliteral">&quot;OnNewGameCreated() called&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span>        PartyArmories.Clear();</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>        CharacterObjectExtension.Init();</div>
<div class="line"><span class="lineno">   84</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, <a class="el" href="../../dc/d87/a00032_source.html#l00081">DynamicTroopEquipmentReupload.Extensions.CharacterObjectExtension.Init()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a4f3b53532a6cd49d7c1b79352cba4649" name="a4f3b53532a6cd49d7c1b79352cba4649"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3b53532a6cd49d7c1b79352cba4649">&#9670;&#160;</a></span>OnTroopRecruited()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.OnTroopRecruited </td>
          <td>(</td>
          <td class="paramtype">Hero?</td>          <td class="paramname"><span class="paramname"><em>recruiterHero</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Settlement</td>          <td class="paramname"><span class="paramname"><em>recruitmentSettlement</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Hero</td>          <td class="paramname"><span class="paramname"><em>recruitmentSource</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CharacterObject</td>          <td class="paramname"><span class="paramname"><em>troop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>amount</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>当兵种被招募时的处理逻辑。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recruiterHero</td><td>进行招募的英雄。 </td></tr>
    <tr><td class="paramname">recruitmentSettlement</td><td>招募发生的定居点。 </td></tr>
    <tr><td class="paramname">recruitmentSource</td><td>提供招募的英雄。 </td></tr>
    <tr><td class="paramname">troop</td><td>被招募的兵种。 </td></tr>
    <tr><td class="paramname">amount</td><td>招募数量。 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00383">383</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  387</span>                                                                 {</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">if</span> (recruiterHero == <span class="keyword">null</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>        var party = recruiterHero.PartyBelongedTo;</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">if</span> (!party.IsValid()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>        <span class="comment">// 确保PartyArmories包含party.Id键</span></div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">if</span> (!PartyArmories.TryGetValue(party.Id, out var partyInventory)) {</div>
<div class="line"><span class="lineno">  395</span>            partyInventory          = <span class="keyword">new</span> Dictionary&lt;ItemObject, int&gt;();</div>
<div class="line"><span class="lineno">  396</span>            PartyArmories[party.Id] = partyInventory;</div>
<div class="line"><span class="lineno">  397</span>        }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>        var list = RecruitmentPatch.GetRecruitEquipments(troop);</div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordflow">foreach</span> (var element <span class="keywordflow">in</span> list) {</div>
<div class="line"><span class="lineno">  401</span>            <span class="comment">// 确保partyInventory包含element.Item键</span></div>
<div class="line"><span class="lineno">  402</span>            <span class="keywordflow">if</span> (!partyInventory.TryGetValue(element.Item, out var count)) count = 0;</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>            partyInventory[element.Item] = count + amount;</div>
<div class="line"><span class="lineno">  405</span>        }</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        Global.Log($<span class="stringliteral">&quot;troop {troop.Name}x{amount} recruited by recruiterHero={recruiterHero.Name} in party {party.Name}, {list.Count * amount} start equipment added&quot;</span>,</div>
<div class="line"><span class="lineno">  408</span>                   Colors.Green,</div>
<div class="line"><span class="lineno">  409</span>                   Level.Debug);</div>
<div class="line"><span class="lineno">  410</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d09/a00077_source.html#l00028">DynamicTroopEquipmentReupload.Patches.RecruitmentPatch.GetRecruitEquipments()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00121">DynamicTroopEquipmentReupload.Global.Log()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<a id="a848f68b66759fb2ac5c29768a8729597" name="a848f68b66759fb2ac5c29768a8729597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848f68b66759fb2ac5c29768a8729597">&#9670;&#160;</a></span>RegisterEvents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">override void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.RegisterEvents </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00065">65</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>                                          {</div>
<div class="line"><span class="lineno">   66</span>        CampaignEvents.MobilePartyCreated.AddNonSerializedListener(<span class="keyword">this</span>, OnMobilePartyCreated);</div>
<div class="line"><span class="lineno">   67</span>        CampaignEvents.MobilePartyDestroyed.AddNonSerializedListener(<span class="keyword">this</span>, OnMobilePartyDestroyed);</div>
<div class="line"><span class="lineno">   68</span>        CampaignEvents.MapEventEnded.AddNonSerializedListener(<span class="keyword">this</span>, OnMapEventEnded);</div>
<div class="line"><span class="lineno">   69</span>        CampaignEvents.OnTroopRecruitedEvent.AddNonSerializedListener(<span class="keyword">this</span>, OnTroopRecruited);</div>
<div class="line"><span class="lineno">   70</span>        CampaignEvents.DailyTickPartyEvent.AddNonSerializedListener(<span class="keyword">this</span>, DailyTickParty);</div>
<div class="line"><span class="lineno">   71</span>        CampaignEvents.WeeklyTickEvent.AddNonSerializedListener(<span class="keyword">this</span>, WeeklyTick);</div>
<div class="line"><span class="lineno">   72</span>        CampaignEvents.OnGameLoadedEvent.AddNonSerializedListener(<span class="keyword">this</span>, OnGameLoaded);</div>
<div class="line"><span class="lineno">   73</span>        CampaignEvents.OnNewGameCreatedEvent.AddNonSerializedListener(<span class="keyword">this</span>, OnNewGameCreated);</div>
<div class="line"><span class="lineno">   74</span>        InitializeItemListByType();</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>        <span class="comment">//Global.InitializeCraftingTemplatesByItemType();</span></div>
<div class="line"><span class="lineno">   77</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00163">DailyTickParty()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00053">InitializeItemListByType()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00087">OnGameLoaded()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00271">OnMapEventEnded()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00240">OnMobilePartyCreated()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00260">OnMobilePartyDestroyed()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00079">OnNewGameCreated()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00383">OnTroopRecruited()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00123">WeeklyTick()</a>.</p>

</div>
</div>
<a id="ac2a1539ac4ecbd5bf42af1d620a7d9eb" name="ac2a1539ac4ecbd5bf42af1d620a7d9eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2a1539ac4ecbd5bf42af1d620a7d9eb">&#9670;&#160;</a></span>SyncData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">override void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.SyncData </td>
          <td>(</td>
          <td class="paramtype">IDataStore</td>          <td class="paramname"><span class="paramname"><em>dataStore</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00099">99</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>                                                        {</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">if</span> (dataStore.IsSaving) {</div>
<div class="line"><span class="lineno">  101</span>            _data.PartyArmories = ConvertToUIntGuidDict(PartyArmories);</div>
<div class="line"><span class="lineno">  102</span>            var tempData = _data;</div>
<div class="line"><span class="lineno">  103</span>            <span class="keywordflow">if</span> (dataStore.SyncDataAsJson(<span class="stringliteral">&quot;DynamicTroopPartyArmories&quot;</span>, ref tempData) &amp;&amp; tempData != <span class="keyword">null</span>) {</div>
<div class="line"><span class="lineno">  104</span>                _data = tempData;</div>
<div class="line"><span class="lineno">  105</span>                Global.Debug($<span class="stringliteral">&quot;saved {PartyArmories.Count} entries&quot;</span>);</div>
<div class="line"><span class="lineno">  106</span>                _data.PartyArmories.Clear();</div>
<div class="line"><span class="lineno">  107</span>            }</div>
<div class="line"><span class="lineno">  108</span>            <span class="keywordflow">else</span> { Global.Error(<span class="stringliteral">&quot;Save Error&quot;</span>); }</div>
<div class="line"><span class="lineno">  109</span>        }</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataStore.IsLoading) {</div>
<div class="line"><span class="lineno">  111</span>            _data.PartyArmories.Clear();</div>
<div class="line"><span class="lineno">  112</span>            var tempData = _data;</div>
<div class="line"><span class="lineno">  113</span>            <span class="keywordflow">if</span> (dataStore.SyncDataAsJson(<span class="stringliteral">&quot;DynamicTroopPartyArmories&quot;</span>, ref tempData) &amp;&amp; tempData != <span class="keyword">null</span>) {</div>
<div class="line"><span class="lineno">  114</span>                _data         = tempData;</div>
<div class="line"><span class="lineno">  115</span>                PartyArmories = ConvertToGuidDict(_data.PartyArmories);</div>
<div class="line"><span class="lineno">  116</span>                _data.PartyArmories.Clear();</div>
<div class="line"><span class="lineno">  117</span>                Global.Debug($<span class="stringliteral">&quot;loaded {PartyArmories.Count} entries&quot;</span>);</div>
<div class="line"><span class="lineno">  118</span>            }</div>
<div class="line"><span class="lineno">  119</span>            <span class="keywordflow">else</span> { Global.Error(<span class="stringliteral">&quot;Load Error&quot;</span>); }</div>
<div class="line"><span class="lineno">  120</span>        }</div>
<div class="line"><span class="lineno">  121</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/a00017_source.html#l00030">_data</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00482">ConvertToGuidDict()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00438">ConvertToUIntGuidDict()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00155">DynamicTroopEquipmentReupload.Global.Debug()</a>, <a class="el" href="../../d4/dee/a00008_source.html#l00161">DynamicTroopEquipmentReupload.Global.Error()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00028">PartyArmories</a>.</p>

</div>
</div>
<a id="a1979ab8566728a620705cc9da22d3019" name="a1979ab8566728a620705cc9da22d3019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1979ab8566728a620705cc9da22d3019">&#9670;&#160;</a></span>WeeklyTick()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.WeeklyTick </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00123">123</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  123</span>                              {</div>
<div class="line"><span class="lineno">  124</span>        <span class="comment">//GarbageCollectParties();</span></div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">//GarbageCollectEquipments();</span></div>
<div class="line"><span class="lineno">  126</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00065">RegisterEvents()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a74949c27fb8960a00ddaf2775e5d2b40" name="a74949c27fb8960a00ddaf2775e5d2b40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74949c27fb8960a00ddaf2775e5d2b40">&#9670;&#160;</a></span>_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dc2/a00228.html">Data</a> DynamicTroopEquipmentReupload.EveryoneCampaignBehavior._data = new()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00030">30</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00099">SyncData()</a>.</p>

</div>
</div>
<a id="a37a997f04b6c4dabc65290195a38ee65" name="a37a997f04b6c4dabc65290195a38ee65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37a997f04b6c4dabc65290195a38ee65">&#9670;&#160;</a></span>EquipmentAndThresholds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly Dictionary&lt;ItemObject.ItemTypeEnum, Func&lt;int, int&gt; &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.EquipmentAndThresholds</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        <span class="keyword">new</span>() {</div>
<div class="line">                  { ItemObject.ItemTypeEnum.BodyArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.LegArmor, memberCnt =&gt; Math.Max(2     * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.HeadArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.HandArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Cape, memberCnt =&gt; Math.Max(2         * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Shield, memberCnt =&gt; Math.Max(2       * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Horse, memberCnt =&gt; Math.Max(2        * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.HorseHarness, memberCnt =&gt; Math.Max(2 * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Bow, memberCnt =&gt; Math.Max(2          * memberCnt, memberCnt + 100) },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Crossbow, memberCnt =&gt; Math.Max(2     * memberCnt, memberCnt + 100) }, {</div>
<div class="line">                                                                                                                       ItemObject.ItemTypeEnum.OneHandedWeapon, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400)</div>
<div class="line">                                                                                                                   }, {</div>
<div class="line">                                                                                                                          ItemObject.ItemTypeEnum.TwoHandedWeapon, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400)</div>
<div class="line">                                                                                                                      },</div>
<div class="line">                  { ItemObject.ItemTypeEnum.Polearm, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400) }</div>
<div class="line">              }</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00032">32</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>              {</div>
<div class="line"><span class="lineno">   34</span>                  { ItemObject.ItemTypeEnum.BodyArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   35</span>                  { ItemObject.ItemTypeEnum.LegArmor, memberCnt =&gt; Math.Max(2     * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   36</span>                  { ItemObject.ItemTypeEnum.HeadArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   37</span>                  { ItemObject.ItemTypeEnum.HandArmor, memberCnt =&gt; Math.Max(2    * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   38</span>                  { ItemObject.ItemTypeEnum.Cape, memberCnt =&gt; Math.Max(2         * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   39</span>                  { ItemObject.ItemTypeEnum.Shield, memberCnt =&gt; Math.Max(2       * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   40</span>                  { ItemObject.ItemTypeEnum.Horse, memberCnt =&gt; Math.Max(2        * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   41</span>                  { ItemObject.ItemTypeEnum.HorseHarness, memberCnt =&gt; Math.Max(2 * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   42</span>                  { ItemObject.ItemTypeEnum.Bow, memberCnt =&gt; Math.Max(2          * memberCnt, memberCnt + 100) },</div>
<div class="line"><span class="lineno">   43</span>                  { ItemObject.ItemTypeEnum.Crossbow, memberCnt =&gt; Math.Max(2     * memberCnt, memberCnt + 100) }, {</div>
<div class="line"><span class="lineno">   44</span>                                                                                                                       ItemObject.ItemTypeEnum.OneHandedWeapon, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400)</div>
<div class="line"><span class="lineno">   45</span>                                                                                                                   }, {</div>
<div class="line"><span class="lineno">   46</span>                                                                                                                          ItemObject.ItemTypeEnum.TwoHandedWeapon, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400)</div>
<div class="line"><span class="lineno">   47</span>                                                                                                                      },</div>
<div class="line"><span class="lineno">   48</span>                  { ItemObject.ItemTypeEnum.Polearm, memberCnt =&gt; Math.Max(8 * memberCnt, 4 * memberCnt + 400) }</div>
<div class="line"><span class="lineno">   49</span>              };</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00128">GarbageCollectEquipments()</a>, and <a class="el" href="../../d7/d46/a00002_source.html#l00263">DynamicTroopEquipmentReupload.ArmyArmory.SellExcessEquipment()</a>.</p>

</div>
</div>
<a id="a1a01e9b809999805a925dfa8be45a3ec" name="a1a01e9b809999805a925dfa8be45a3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a01e9b809999805a925dfa8be45a3ec">&#9670;&#160;</a></span>ItemListByType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly Dictionary&lt;ItemObject.ItemTypeEnum, List&lt;ItemObject&gt; &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.ItemListByType = new()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00051">51</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/de7/a00014_source.html#l00050">DynamicTroopEquipmentReupload.Cache.GetItemsByTypeTierAndCulture()</a>, and <a class="el" href="../../d4/d51/a00017_source.html#l00053">InitializeItemListByType()</a>.</p>

</div>
</div>
<a id="a127741273bf1c746a3a918789232fe9b" name="a127741273bf1c746a3a918789232fe9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a127741273bf1c746a3a918789232fe9b">&#9670;&#160;</a></span>PartyArmories</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Dictionary&lt;MBGUID, Dictionary&lt;ItemObject, int&gt; &gt; DynamicTroopEquipmentReupload.EveryoneCampaignBehavior.PartyArmories = new()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d51/a00017_source.html#l00028">28</a> of file <a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d51/a00017_source.html#l00418">AddItemToPartyArmory()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00128">GarbageCollectEquipments()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00179">GarbageCollectParties()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00339">GetAllLootItems()</a>, <a class="el" href="../../d6/d5b/a00026_source.html#l00020">DynamicTroopEquipmentReupload.Extensions.MobilePartyExtension.IsValid()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00087">OnGameLoaded()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00240">OnMobilePartyCreated()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00260">OnMobilePartyDestroyed()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00079">OnNewGameCreated()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00383">OnTroopRecruited()</a>, <a class="el" href="../../d0/d89/a00071_source.html#l00020">DynamicTroopEquipmentReupload.Patches.ItemRosterForPlayerLootSharePatch.Postfix()</a>, <a class="el" href="../../d6/d2d/a00047_source.html#l00906">DynamicTroopEquipmentReupload.PartyEquipmentDistributor.ReturnItem()</a>, <a class="el" href="../../d6/d2d/a00047_source.html#l00879">DynamicTroopEquipmentReupload.PartyEquipmentDistributor.Spawn()</a>, <a class="el" href="../../d4/d51/a00017_source.html#l00099">SyncData()</a>, <a class="el" href="../../da/d45/a00011_source.html#l00630">DynamicTroopEquipmentReupload.CutTheirSupplyBehavior.TransferCargoToTargetStash()</a>, and <a class="el" href="../../d0/dc2/a00104_source.html#l00052">DynamicTroopEquipmentReupload.DynamicTroopMissionLogic.TryInitializeDistributors()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../d4/d51/a00017_source.html">EveryoneCampaignBehavior.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
